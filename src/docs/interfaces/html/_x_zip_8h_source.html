<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>interfaces: public/zip/XZip.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">interfaces
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_x_zip_8h_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">XZip.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_x_zip_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// XZip.h  Version 1.1</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Authors:      Mark Adler et al. (see below)</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Modified by:  Lucian Wischik</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//               lu@wischik.com</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Version 1.0   - Turned C files into just a single CPP file</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//               - Made them compile cleanly as C++ files</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//               - Gave them simpler APIs</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//               - Added the ability to zip/unzip directly in memory without </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//                 any intermediate files</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// Modified by:  Hans Dietrich</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//               hdietrich2@hotmail.com</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Version 1.1:  - Added Unicode support to CreateZip() and ZipAdd()</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//               - Changed file names to avoid conflicts with Lucian&#39;s files</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span><span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Lucian Wischik&#39;s comments:</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// --------------------------</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// THIS FILE is almost entirely based upon code by info-zip.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// It has been modified by Lucian Wischik.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// The original code may be found at http://www.info-zip.org</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// The original copyright text follows.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span><span class="comment">//</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Original authors&#39; comments:</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// ---------------------------</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// This is version 2002-Feb-16 of the Info-ZIP copyright and license. The </span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// definitive version of this document should be available at </span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// ftp://ftp.info-zip.org/pub/infozip/license.html indefinitely.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Copyright (c) 1990-2002 Info-ZIP.  All rights reserved.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// For the purposes of this copyright and license, &quot;Info-ZIP&quot; is defined as</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// the following set of individuals:</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//   Mark Adler, John Bush, Karl Davis, Harald Denker, Jean-Michel Dubois,</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//   Jean-loup Gailly, Hunter Goatley, Ian Gorman, Chris Herborth, Dirk Haase,</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//   Greg Hartwig, Robert Heath, Jonathan Hudson, Paul Kienitz, </span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//   David Kirschbaum, Johnny Lee, Onno van der Linden, Igor Mandrichenko, </span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//   Steve P. Miller, Sergio Monesi, Keith Owens, George Petrov, Greg Roelofs, </span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//   Kai Uwe Rommel, Steve Salisbury, Dave Smith, Christian Spieler, </span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//   Antoine Verheijen, Paul von Behren, Rich Wales, Mike White</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// This software is provided &quot;as is&quot;, without warranty of any kind, express</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// or implied.  In no event shall Info-ZIP or its contributors be held liable</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// for any direct, indirect, incidental, special or consequential damages</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// arising out of the use of or inability to use this software.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// Permission is granted to anyone to use this software for any purpose,</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// including commercial applications, and to alter it and redistribute it</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// freely, subject to the following restrictions:</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//    1. Redistributions of source code must retain the above copyright notice,</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//       definition, disclaimer, and this list of conditions.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//    2. Redistributions in binary form (compiled executables) must reproduce </span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//       the above copyright notice, definition, disclaimer, and this list of </span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//       conditions in documentation and/or other materials provided with the </span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//       distribution. The sole exception to this condition is redistribution </span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//       of a standard UnZipSFX binary as part of a self-extracting archive; </span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//       that is permitted without inclusion of this license, as long as the </span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//       normal UnZipSFX banner has not been removed from the binary or disabled.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//    3. Altered versions--including, but not limited to, ports to new </span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//       operating systems, existing ports with new graphical interfaces, and </span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//       dynamic, shared, or static library versions--must be plainly marked </span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//       as such and must not be misrepresented as being the original source.  </span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//       Such altered versions also must not be misrepresented as being </span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//       Info-ZIP releases--including, but not limited to, labeling of the </span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//       altered versions with the names &quot;Info-ZIP&quot; (or any variation thereof, </span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//       including, but not limited to, different capitalizations), </span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//       &quot;Pocket UnZip&quot;, &quot;WiZ&quot; or &quot;MacZip&quot; without the explicit permission of </span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//       Info-ZIP.  Such altered versions are further prohibited from </span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//       misrepresentative use of the Zip-Bugs or Info-ZIP e-mail addresses or </span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//       of the Info-ZIP URL(s).</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//    4. Info-ZIP retains the right to use the names &quot;Info-ZIP&quot;, &quot;Zip&quot;, &quot;UnZip&quot;,</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//       &quot;UnZipSFX&quot;, &quot;WiZ&quot;, &quot;Pocket UnZip&quot;, &quot;Pocket Zip&quot;, and &quot;MacZip&quot; for its </span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//       own source and binary releases.</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#ifndef XZIP_H</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#define XZIP_H</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// ZIP functions -- for creating zip files</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// This file is a repackaged form of the Info-Zip source code available</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">// at www.info-zip.org. The original copyright notice may be found in</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// zip.cpp. The repackaging was done by Lucian Wischik to simplify its</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// use in Windows/C++.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#if !defined( DWORD )</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="_x_zip_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a798af1e30bc65f319c1a246cecf59e39">  102</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_x_zip_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#if !defined( TCHAR )</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a03bdb8ce5895c7e261aadc2529637546">  107</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">char</span> <a class="code" href="_x_zip_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#ifndef XUNZIP_H</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#if !defined(DECLARE_HANDLE)</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#if !defined(HANDLE)</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aa8c0374618b33785ccb02f74bcfebc46">  113</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">void</span> * <a class="code" href="_x_zip_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aec4871ff366a33730b02718ef1c85c0c">  115</a></span>&#160;<span class="preprocessor">#define DECLARE_HANDLE(name) typedef struct name##__ { int unused; } *name</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<a class="code" href="_x_zip_8h.html#aec4871ff366a33730b02718ef1c85c0c">DECLARE_HANDLE</a>(HZIP);       <span class="comment">// An HZIP identifies a zip file that is being created</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a84e83d544ba10017a4674ff397206382">  120</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="dxabstract__types_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="_x_zip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a>;      <span class="comment">// result codes from any of the zip functions. Listed later.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// flag values passed to some functions</span></div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a57c1d6eea6f257dea453d29f8e882669">  123</a></span>&#160;<span class="preprocessor">#define ZIP_HANDLE   1</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#ad3d9f5d82ea79c54360e182dbcb2e56f">  124</a></span>&#160;<span class="preprocessor">#define ZIP_FILENAME 2</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a81e59ce3707b6ca84dfd5b14c8a1a1d7">  125</a></span>&#160;<span class="preprocessor">#define ZIP_MEMORY   3</span></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a12ae0c2a8134d2e846c823c9ccfa5512">  126</a></span>&#160;<span class="preprocessor">#define ZIP_FOLDER   4</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">// CreateZip()</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">// Purpose:     Create a zip archive file</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// Parameters:  z      - archive file name if flags is ZIP_FILENAME;  for other</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">//                       uses see below</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">//              len    - for memory (ZIP_MEMORY) should be the buffer size;</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">//                       for other uses, should be 0</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//              flags  - indicates usage, see below;  for files, this will be</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//                       ZIP_FILENAME</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">// Returns:     HZIP   - non-zero if zip archive created ok, otherwise 0</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;HZIP <a class="code" href="_x_zip_8h.html#a66cff9df0940bec28b54e6aaf20a9c81">CreateZip</a>(<span class="keywordtype">void</span> *z, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len, <a class="code" href="dxabstract__types_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="glfuncs_8h.html#aa6c93bd4221a61daf80570d28f06267c">flags</a>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// CreateZip - call this to start the creation of a zip file.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">// As the zip is being created, it will be stored somewhere:</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">// to a pipe:              CreateZip(hpipe_write, 0,ZIP_HANDLE);</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">// in a file (by handle):  CreateZip(hfile, 0,ZIP_HANDLE);</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// in a file (by name):    CreateZip(&quot;c:\\test.zip&quot;, 0,ZIP_FILENAME);</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">// in memory:              CreateZip(buf, len,ZIP_MEMORY);</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">// or in pagefile memory:  CreateZip(0, len,ZIP_MEMORY);</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">// The final case stores it in memory backed by the system paging file,</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// where the zip may not exceed len bytes. This is a bit friendlier than</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">// allocating memory with new[]: it won&#39;t lead to fragmentation, and the</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">// memory won&#39;t be touched unless needed.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">// Note: because pipes don&#39;t allow random access, the structure of a zipfile</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// created into a pipe is slightly different from that created into a file</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// or memory. In particular, the compressed-size of the item cannot be</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">// stored in the zipfile until after the item itself. (Also, for an item added</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">// itself via a pipe, the uncompressed-size might not either be known until</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">// after.) This is not normally a problem. But if you try to unzip via a pipe</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">// as well, then the unzipper will not know these things about the item until</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">// after it has been unzipped. Therefore: for unzippers which don&#39;t just write</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">// each item to disk or to a pipe, but instead pre-allocate memory space into</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// which to unzip them, then either you have to create the zip not to a pipe,</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// or you have to add items not from a pipe, or at least when adding items</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">// from a pipe you have to specify the length.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">// ZipAdd()</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">// Purpose:     Add a file to a zip archive</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">// Parameters:  hz      - handle to an open zip archive</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//              dstzn   - name used inside the zip archive to identify the file</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">//              src     - for a file (ZIP_FILENAME) this specifies the filename</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">//                        to be added to the archive;  for other uses, see below</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">//              len     - for memory (ZIP_MEMORY) this specifies the buffer </span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">//                        length;  for other uses, this should be 0</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">//              flags   - indicates usage, see below;  for files, this will be</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">//                        ZIP_FILENAME</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">// Returns:     ZRESULT - ZR_OK if success, otherwise some other value</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<a class="code" href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a> <a class="code" href="_x_zip_8h.html#aaac3baebfb34c340d1a2944f79b3bbc3">ZipAdd</a>(HZIP hz, <span class="keyword">const</span> <a class="code" href="_x_unzip_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *dstzn, <span class="keywordtype">void</span> *src, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len, <a class="code" href="dxabstract__types_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="glfuncs_8h.html#aa6c93bd4221a61daf80570d28f06267c">flags</a>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">// ZipAdd - call this for each file to be added to the zip.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">// dstzn is the name that the file will be stored as in the zip file.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">// The file to be added to the zip can come</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">// from a pipe:  ZipAdd(hz,&quot;file.dat&quot;, hpipe_read,0,ZIP_HANDLE);</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">// from a file:  ZipAdd(hz,&quot;file.dat&quot;, hfile,0,ZIP_HANDLE);</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">// from a fname: ZipAdd(hz,&quot;file.dat&quot;, &quot;c:\\docs\\origfile.dat&quot;,0,ZIP_FILENAME);</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">// from memory:  ZipAdd(hz,&quot;subdir\\file.dat&quot;, buf,len,ZIP_MEMORY);</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">// (folder):     ZipAdd(hz,&quot;subdir&quot;,   0,0,ZIP_FOLDER);</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">// Note: if adding an item from a pipe, and if also creating the zip file itself</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">// to a pipe, then you might wish to pass a non-zero length to the ZipAdd</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">// function. This will let the zipfile store the items size ahead of the</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">// compressed item itself, which in turn makes it easier when unzipping the</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">// zipfile into a pipe.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">// CloseZip()</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">// Purpose:     Close an open zip archive</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">// Parameters:  hz      - handle to an open zip archive</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">// Returns:     ZRESULT - ZR_OK if success, otherwise some other value</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<a class="code" href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a> <a class="code" href="_x_zip_8h.html#a27d41111663a816363ed2f5abfb7107d">CloseZip</a>(HZIP hz);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">// CloseZip - the zip handle must be closed with this function.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<a class="code" href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a> <a class="code" href="_x_zip_8h.html#a6b12c68ad8f8ad87acf17b833d434206">ZipGetMemory</a>(HZIP hz, <span class="keywordtype">void</span> **buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *len);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">// ZipGetMemory - If the zip was created in memory, via ZipCreate(0,ZIP_MEMORY),</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">// then this function will return information about that memory block.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">// buf will receive a pointer to its start, and len its length.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">// Note: you can&#39;t add any more after calling this.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_x_zip_8h.html#ad1cf6c76ae2d38246c3190248dc29b0f">FormatZipMessage</a>(<a class="code" href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a> code, <span class="keywordtype">char</span> *buf,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">// FormatZipMessage - given an error code, formats it as a string.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// It returns the length of the error message. If buf/len points</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">// to a real buffer, then it also writes as much as possible into there.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">// These are the result codes:</span></div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a73a776dd2bf2df30cd66656186a1d91c">  232</a></span>&#160;<span class="preprocessor">#define ZR_OK         0x00000000     // nb. the pseudo-code zr-recent is never returned,</span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#ab9017a722f40ad7c8e3750588fb6f035">  233</a></span>&#160;<span class="preprocessor">#define ZR_RECENT     0x00000001     // but can be passed to FormatZipMessage.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">// The following come from general system stuff (e.g. files not openable)</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a40ba4f5c440ed48513933ce9994a6658">  235</a></span>&#160;<span class="preprocessor">#define ZR_GENMASK    0x0000FF00</span></div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a9543f02880a364ae99f41d52840d7173">  236</a></span>&#160;<span class="preprocessor">#define ZR_NODUPH     0x00000100     // couldn&#39;t duplicate the handle</span></div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aef1727e0240e0cf2a6ff274e23b9af57">  237</a></span>&#160;<span class="preprocessor">#define ZR_NOFILE     0x00000200     // couldn&#39;t create/open the file</span></div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aa3dd19c5b310300f3251c18f35f69a69">  238</a></span>&#160;<span class="preprocessor">#define ZR_NOALLOC    0x00000300     // failed to allocate some resource</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a47dd0d6869573a3f918fed82962bf0f5">  239</a></span>&#160;<span class="preprocessor">#define ZR_WRITE      0x00000400     // a general error writing to the file</span></div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a3b2594fb10796e83ab80dd13e7a3b78a">  240</a></span>&#160;<span class="preprocessor">#define ZR_NOTFOUND   0x00000500     // couldn&#39;t find that file in the zip</span></div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#adf62f679d0629164c5c3d55084c93222">  241</a></span>&#160;<span class="preprocessor">#define ZR_MORE       0x00000600     // there&#39;s still more data to be unzipped</span></div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a7c85b039ddee9436d88b17b919e7bb00">  242</a></span>&#160;<span class="preprocessor">#define ZR_CORRUPT    0x00000700     // the zipfile is corrupt or not a zipfile</span></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aa392aeb74f77c45ed681fefd58cc0a89">  243</a></span>&#160;<span class="preprocessor">#define ZR_READ       0x00000800     // a general error reading the file</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">// The following come from mistakes on the part of the caller</span></div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#ac0f4da0df349c9423d1c9a881553c77f">  245</a></span>&#160;<span class="preprocessor">#define ZR_CALLERMASK 0x00FF0000</span></div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#ae99224e5afbd19c0041072808b25cf27">  246</a></span>&#160;<span class="preprocessor">#define ZR_ARGS       0x00010000     // general mistake with the arguments</span></div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a7fa455c3f5ceefceb6977f142075a788">  247</a></span>&#160;<span class="preprocessor">#define ZR_NOTMMAP    0x00020000     // tried to ZipGetMemory, but that only works on mmap zipfiles, which yours wasn&#39;t</span></div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#acb604b741a91fb905805a7985c810f42">  248</a></span>&#160;<span class="preprocessor">#define ZR_MEMSIZE    0x00030000     // the memory size is too small</span></div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a77547b80440f59bfd28a4ac89fd033c6">  249</a></span>&#160;<span class="preprocessor">#define ZR_FAILED     0x00040000     // the thing was already failed when you called this function</span></div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a02120ed2ebc636ff1bcf9d6ba5328149">  250</a></span>&#160;<span class="preprocessor">#define ZR_ENDED      0x00050000     // the zip creation has already been closed</span></div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aa7c250761e018104552ab588716c2d6b">  251</a></span>&#160;<span class="preprocessor">#define ZR_MISSIZE    0x00060000     // the indicated input file size turned out mistaken</span></div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a4ff0dca25ccbb214c97c07e33abd5846">  252</a></span>&#160;<span class="preprocessor">#define ZR_PARTIALUNZ 0x00070000     // the file had already been partially unzipped</span></div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a8f61a3c82a2a5eec83ad5488533aac93">  253</a></span>&#160;<span class="preprocessor">#define ZR_ZMODE      0x00080000     // tried to mix creating/opening a zip </span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">// The following come from bugs within the zip library itself</span></div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a729156494aa981344ff1f3c06c8b9682">  255</a></span>&#160;<span class="preprocessor">#define ZR_BUGMASK    0xFF000000</span></div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a2867ba7f83ebb5ffcbdb14b0f23a2b98">  256</a></span>&#160;<span class="preprocessor">#define ZR_NOTINITED  0x01000000     // initialisation didn&#39;t work</span></div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a048781d52b176de34f03c6bff24bfbf9">  257</a></span>&#160;<span class="preprocessor">#define ZR_SEEK       0x02000000     // trying to seek in an unseekable file</span></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#aea74b1c007e064d51d68a4ca5008b152">  258</a></span>&#160;<span class="preprocessor">#define ZR_NOCHANGE   0x04000000     // changed its mind on storage, but not allowed</span></div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a64b7ebad02a03d3f890f8bd088e5550a">  259</a></span>&#160;<span class="preprocessor">#define ZR_FLATE      0x05000000     // an internal error in the de/inflation code</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">// e.g.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">// (1) Traditional use, creating a zipfile from existing files</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//     HZIP hz = CreateZip(&quot;c:\\temp.zip&quot;,0,ZIP_FILENAME);</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//     ZipAdd(hz,&quot;src1.txt&quot;,  &quot;c:\\src1.txt&quot;,0,ZIP_FILENAME);</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//     ZipAdd(hz,&quot;src2.bmp&quot;,  &quot;c:\\src2_origfn.bmp&quot;,0,ZIP_FILENAME);</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//     CloseZip(hz);</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">// (2) Memory use, creating an auto-allocated mem-based zip file from various sources</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">//     HZIP hz = CreateZip(0,100000,ZIP_MEMORY);</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">//     // adding a conventional file...</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">//     ZipAdd(hz,&quot;src1.txt&quot;,  &quot;c:\\src1.txt&quot;,0,ZIP_FILENAME);</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">//     // adding something from memory...</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//     char buf[1000]; for (int i=0; i&lt;1000; i++) buf[i]=(char)(i&amp;0x7F);</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//     ZipAdd(hz,&quot;file.dat&quot;,  buf,1000,ZIP_MEMORY);</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//     // adding something from a pipe...</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">//     HANDLE hread,hwrite; CreatePipe(&amp;hread,&amp;write,NULL,0);</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//     HANDLE hthread = CreateThread(ThreadFunc,(void*)hwrite);</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">//     ZipAdd(hz,&quot;unz3.dat&quot;,  hread,0,ZIP_HANDLE);</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//     WaitForSingleObject(hthread,INFINITE);</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">//     CloseHandle(hthread); CloseHandle(hread);</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">//     ... meanwhile DWORD CALLBACK ThreadFunc(void *dat)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//                   { HANDLE hwrite = (HANDLE)dat;</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">//                     char buf[1000]={17};</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">//                     DWORD writ; WriteFile(hwrite,buf,1000,&amp;writ,NULL);</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">//                     CloseHandle(hwrite);</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">//                     return 0;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">//                   }</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">//     // and now that the zip is created, let&#39;s do something with it:</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">//     void *zbuf; unsigned long zlen; ZipGetMemory(hz,&amp;zbuf,&amp;zlen);</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//     HANDLE hfz = CreateFile(&quot;test2.zip&quot;,GENERIC_WRITE,CREATE_ALWAYS);</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//     DWORD writ; WriteFile(hfz,zbuf,zlen,&amp;writ,NULL);</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">//     CloseHandle(hfz);</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">//     CloseZip(hz);</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">// (3) Handle use, for file handles and pipes</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">//     HANDLE hzread,hzwrite; CreatePipe(&amp;hzread,&amp;hzwrite);</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//     HANDLE hthread = CreateThread(ZipReceiverThread,(void*)hread);</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">//     HZIP hz = ZipCreate(hzwrite,ZIP_HANDLE);</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//     // ... add to it</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">//     CloseZip(hz);</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">//     CloseHandle(hzwrite);</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">//     WaitForSingleObject(hthread,INFINITE);</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">//     CloseHandle(hthread);</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">//     ... meanwhile DWORD CALLBACK ThreadFunc(void *dat)</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">//                   { HANDLE hread = (HANDLE)dat;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">//                     char buf[1000];</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">//                     while (true)</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">//                     { DWORD red; ReadFile(hread,buf,1000,&amp;red,NULL);</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">//                       // ... and do something with this zip data we&#39;re receiving</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">//                       if (red==0) break;</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">//                     }</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">//                     CloseHandle(hread);</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">//                     return 0;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//                   }</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">// Now we indulge in a little skullduggery so that the code works whether</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">// the user has included just zip or both zip and unzip.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">// Idea: if header files for both zip and unzip are present, then presumably</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">// the cpp files for zip and unzip are both present, so we will call</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">// one or the other of them based on a dynamic choice. If the header file</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">// for only one is present, then we will bind to that particular one.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;HZIP <a class="code" href="_x_zip_8h.html#a223d9abb3d67d697c7b79a2d92952c1c">CreateZipZ</a>(<span class="keywordtype">void</span> *z,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len,<a class="code" href="dxabstract__types_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="glfuncs_8h.html#aa6c93bd4221a61daf80570d28f06267c">flags</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<a class="code" href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a> <a class="code" href="_x_zip_8h.html#abd59983b59f841dafb3e364b37a91010">CloseZipZ</a>(HZIP hz);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_x_zip_8h.html#a3b53cdc81ac8bc489d1b6a2a7af08295">FormatZipMessageZ</a>(<a class="code" href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a> code, <span class="keywordtype">char</span> *buf,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_x_zip_8h.html#ad5b1e9f6b01bbaebf376dbfd70e763cb">IsZipHandleZ</a>(HZIP hz);</div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a66cff9df0940bec28b54e6aaf20a9c81">  331</a></span>&#160;<span class="preprocessor">#define CreateZip CreateZipZ</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">#ifdef XUNZIP_H</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#undef CloseZip</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#define CloseZip(hz) (IsZipHandleZ(hz)?CloseZipZ(hz):CloseZipU(hz))</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#a27d41111663a816363ed2f5abfb7107d">  337</a></span>&#160;<span class="preprocessor">#define CloseZip CloseZipZ</span></div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="_x_zip_8h.html#ad1cf6c76ae2d38246c3190248dc29b0f">  338</a></span>&#160;<span class="preprocessor">#define FormatZipMessage FormatZipMessageZ</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif //XZIP_H</span></div><div class="ttc" id="glfuncs_8h_html_aa6c93bd4221a61daf80570d28f06267c"><div class="ttname"><a href="glfuncs_8h.html#aa6c93bd4221a61daf80570d28f06267c">flags</a></div><div class="ttdeci">GLenum a GLhandleARB GLhandleARB b GLhandleARB GLuint const GLcharARB c GLenum GLuint b GLclampf GLclampf GLclampf GLclampf d GLenum GLenum b GLbitfield a GLclampd a GLenum const GLdouble b GLhandleARB a GLenum GLint GLenum GLsizei GLsizei GLsizei GLint GLsizei const GLvoid i GLenum a GLhandleARB a GLsizei const GLuint b GLsizei const GLuint b GLboolean a GLhandleARB GLhandleARB b GLuint a GLenum a GLenum GLuint GLuint GLsizei GLenum const GLvoid f GLenum a GLsizei GLuint b GLsizei GLuint b GLenum GLboolean b GLenum GLdouble b GLhandleARB GLsizei GLsizei GLcharARB d GLhandleARB GLenum GLint c const GLubyte GLenum a GLhandleARB const GLcharARB b GLuint a GLvoid GLenum GLenum b GLenum GLint b GLfloat GLfloat b GLenum GLenum GLsizei const GLvoid d GLenum a GLhandleARB GLsizei const GLcharARB const GLint d GLuint a GLfloat GLfloat b GLenum GLint GLint GLsizei GLsizei GLsizei GLint GLenum GLenum const GLvoid j GLenum GLenum GLint c GLint GLfloat b GLint GLint b GLenum a GLfloat GLfloat GLfloat c GLint GLint GLsizei GLsizei d GLenum a GLint GLenum GLsizei const GLvoid d GLenum GLuint GLsizei const GLfloat d GLenum GLenum GLenum GLenum d GLenum GLint GLenum GLint d GLenum GLuint b GLenum a GLenum GLenum GLenum GLuint d GLenum GLenum GLenum GLuint GLint GLint f GLsizei GLuint b GLint GLint GLint GLint GLint GLint GLint GLint GLbitfield GLenum j GLuint a GLuint a GLsizei GLuint b GLuint GLenum b GLsizei const GLuint b GLuint GLboolean GLboolean GLboolean GLboolean e GLenum GLuint b GLuint GLint GLuint c GLenum GLenum b GLenum GLintptr GLsizeiptr c GLenum GLintptr GLsizeiptr c GLenum GLuint b GLuint GLenum GLint c GLenum GLsizei void c GLenum GLuint b GLenum a GLenum GLenum GLenum GLuint d GLenum GLenum GLenum GLuint GLint GLint f GLsizei GLuint b GLint GLint GLint GLint GLint GLint GLint GLint GLbitfield GLenum j GLsizei const void b GLenum GLenum GLenum GLsizei const GLuint GLboolean f GLuint GLuint b GLuint GLuint b GLuint GLenum GLfloat c GLuint texture GLuint64 handle GLint GLuint64 value GLuint GLint GLuint64 value GLuint64 handle GLsizei const GLuint ids GLenum target GLuint GLenum GLint params GLenum GLenum GLintptr GLintptr GLsizeiptr size GLsizei GLuint arrays GLbitfield a GLenum GLsizeiptr const void GLbitfield flags</div><div class="ttdef"><b>Definition:</b> glfuncs.h:270</div></div>
<div class="ttc" id="_x_zip_8h_html_a3b53cdc81ac8bc489d1b6a2a7af08295"><div class="ttname"><a href="_x_zip_8h.html#a3b53cdc81ac8bc489d1b6a2a7af08295">FormatZipMessageZ</a></div><div class="ttdeci">unsigned int FormatZipMessageZ(ZRESULT code, char *buf, unsigned int len)</div><div class="ttdef"><b>Definition:</b> XZip.cpp:2904</div></div>
<div class="ttc" id="dxabstract__types_8h_html_a798af1e30bc65f319c1a246cecf59e39"><div class="ttname"><a href="dxabstract__types_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a></div><div class="ttdeci">unsigned int DWORD</div><div class="ttdef"><b>Definition:</b> dxabstract_types.h:96</div></div>
<div class="ttc" id="_x_zip_8h_html_a798af1e30bc65f319c1a246cecf59e39"><div class="ttname"><a href="_x_zip_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a></div><div class="ttdeci">unsigned int DWORD</div><div class="ttdef"><b>Definition:</b> XZip.h:102</div></div>
<div class="ttc" id="_x_zip_8h_html_aa8c0374618b33785ccb02f74bcfebc46"><div class="ttname"><a href="_x_zip_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a></div><div class="ttdeci">void * HANDLE</div><div class="ttdef"><b>Definition:</b> XZip.h:113</div></div>
<div class="ttc" id="_x_zip_8h_html_a03bdb8ce5895c7e261aadc2529637546"><div class="ttname"><a href="_x_zip_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a></div><div class="ttdeci">char TCHAR</div><div class="ttdef"><b>Definition:</b> XZip.h:107</div></div>
<div class="ttc" id="_x_unzip_8h_html_a84e83d544ba10017a4674ff397206382"><div class="ttname"><a href="_x_unzip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a></div><div class="ttdeci">DWORD ZRESULT</div><div class="ttdef"><b>Definition:</b> XUnzip.h:133</div></div>
<div class="ttc" id="_x_zip_8h_html_aaac3baebfb34c340d1a2944f79b3bbc3"><div class="ttname"><a href="_x_zip_8h.html#aaac3baebfb34c340d1a2944f79b3bbc3">ZipAdd</a></div><div class="ttdeci">ZRESULT ZipAdd(HZIP hz, const TCHAR *dstzn, void *src, unsigned int len, DWORD flags)</div><div class="ttdef"><b>Definition:</b> XZip.cpp:2961</div></div>
<div class="ttc" id="_x_zip_8h_html_abd59983b59f841dafb3e364b37a91010"><div class="ttname"><a href="_x_zip_8h.html#abd59983b59f841dafb3e364b37a91010">CloseZipZ</a></div><div class="ttdeci">ZRESULT CloseZipZ(HZIP hz)</div><div class="ttdef"><b>Definition:</b> XZip.cpp:3017</div></div>
<div class="ttc" id="_x_zip_8h_html_a66cff9df0940bec28b54e6aaf20a9c81"><div class="ttname"><a href="_x_zip_8h.html#a66cff9df0940bec28b54e6aaf20a9c81">CreateZip</a></div><div class="ttdeci">#define CreateZip</div><div class="ttdef"><b>Definition:</b> XZip.h:331</div></div>
<div class="ttc" id="_x_zip_8h_html_aec4871ff366a33730b02718ef1c85c0c"><div class="ttname"><a href="_x_zip_8h.html#aec4871ff366a33730b02718ef1c85c0c">DECLARE_HANDLE</a></div><div class="ttdeci">#define DECLARE_HANDLE(name)</div><div class="ttdef"><b>Definition:</b> XZip.h:115</div></div>
<div class="ttc" id="_x_zip_8h_html_a6b12c68ad8f8ad87acf17b833d434206"><div class="ttname"><a href="_x_zip_8h.html#a6b12c68ad8f8ad87acf17b833d434206">ZipGetMemory</a></div><div class="ttdeci">ZRESULT ZipGetMemory(HZIP hz, void **buf, unsigned long *len)</div><div class="ttdef"><b>Definition:</b> XZip.cpp:3008</div></div>
<div class="ttc" id="_x_zip_8h_html_ad5b1e9f6b01bbaebf376dbfd70e763cb"><div class="ttname"><a href="_x_zip_8h.html#ad5b1e9f6b01bbaebf376dbfd70e763cb">IsZipHandleZ</a></div><div class="ttdeci">bool IsZipHandleZ(HZIP hz)</div><div class="ttdef"><b>Definition:</b> XZip.cpp:3028</div></div>
<div class="ttc" id="_x_zip_8h_html_ad1cf6c76ae2d38246c3190248dc29b0f"><div class="ttname"><a href="_x_zip_8h.html#ad1cf6c76ae2d38246c3190248dc29b0f">FormatZipMessage</a></div><div class="ttdeci">#define FormatZipMessage</div><div class="ttdef"><b>Definition:</b> XZip.h:338</div></div>
<div class="ttc" id="_x_zip_8h_html_a27d41111663a816363ed2f5abfb7107d"><div class="ttname"><a href="_x_zip_8h.html#a27d41111663a816363ed2f5abfb7107d">CloseZip</a></div><div class="ttdeci">#define CloseZip</div><div class="ttdef"><b>Definition:</b> XZip.h:337</div></div>
<div class="ttc" id="_x_unzip_8h_html_a03bdb8ce5895c7e261aadc2529637546"><div class="ttname"><a href="_x_unzip_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a></div><div class="ttdeci">char TCHAR</div><div class="ttdef"><b>Definition:</b> XUnzip.h:101</div></div>
<div class="ttc" id="_x_zip_8h_html_a84e83d544ba10017a4674ff397206382"><div class="ttname"><a href="_x_zip_8h.html#a84e83d544ba10017a4674ff397206382">ZRESULT</a></div><div class="ttdeci">DWORD ZRESULT</div><div class="ttdef"><b>Definition:</b> XZip.h:120</div></div>
<div class="ttc" id="_x_zip_8h_html_a223d9abb3d67d697c7b79a2d92952c1c"><div class="ttname"><a href="_x_zip_8h.html#a223d9abb3d67d697c7b79a2d92952c1c">CreateZipZ</a></div><div class="ttdeci">HZIP CreateZipZ(void *z, unsigned int len, DWORD flags)</div><div class="ttdef"><b>Definition:</b> XZip.cpp:2945</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f832923ad3cb060bc87ad85e68b8a1c3.html">public</a></li><li class="navelem"><a class="el" href="dir_84b711edc8586edb7dd8db720157e0f6.html">zip</a></li><li class="navelem"><a class="el" href="_x_zip_8h.html">XZip.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
